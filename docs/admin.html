<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Skilling â€” Admin Panel</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #1a1a2e;
    color: #e0e0e0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  .panel {
    background: #16213e;
    border: 1px solid #334;
    border-radius: 12px;
    padding: 32px;
    width: 420px;
    max-width: 95vw;
  }
  h1 { font-size: 20px; margin-bottom: 20px; color: #ffd700; }
  label { display: block; font-size: 13px; margin-bottom: 4px; color: #aaa; }
  input, textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #334;
    border-radius: 6px;
    background: #0f3460;
    color: #fff;
    font-size: 14px;
    margin-bottom: 16px;
    outline: none;
  }
  input:focus, textarea:focus { border-color: #ffd700; }
  textarea { resize: vertical; min-height: 80px; }
  button {
    width: 100%;
    padding: 12px;
    background: #ffd700;
    color: #1a1a2e;
    border: none;
    border-radius: 6px;
    font-size: 15px;
    font-weight: bold;
    cursor: pointer;
  }
  button:hover { background: #ffed4a; }
  button:disabled { background: #555; color: #888; cursor: not-allowed; }
  .status {
    margin-top: 12px;
    font-size: 13px;
    text-align: center;
    min-height: 20px;
  }
  .status.ok { color: #6ed998; }
  .status.err { color: #ff6b6b; }
  .conn { font-size: 12px; color: #888; margin-bottom: 16px; }
  .conn.connected { color: #6ed998; }
</style>
</head>
<body>
<div class="panel">
  <h1>Admin Panel</h1>

  <label>Server URL</label>
  <input id="ws-url" value="wss://skilling.onrender.com" />

  <label>Admin Key</label>
  <input id="admin-key" type="password" />

  <div id="conn-status" class="conn">Disconnected</div>

  <label>Broadcast Message</label>
  <textarea id="msg" placeholder="Message to all players..."></textarea>

  <button id="send-btn" disabled>Send Broadcast</button>
  <div id="status" class="status"></div>
</div>

<script>
const wsInput = document.getElementById("ws-url");
const keyInput = document.getElementById("admin-key");
const msgInput = document.getElementById("msg");
const sendBtn = document.getElementById("send-btn");
const statusEl = document.getElementById("status");
const connEl = document.getElementById("conn-status");

let ws = null;

function connect() {
  if (ws) { ws.close(); ws = null; }
  const url = wsInput.value.trim();
  if (!url) return;
  connEl.textContent = "Connecting...";
  connEl.className = "conn";
  ws = new WebSocket(url);
  ws.onopen = () => {
    connEl.textContent = "Connected";
    connEl.className = "conn connected";
    sendBtn.disabled = false;
    // join as admin (doesn't need a room for broadcast, but server requires hello first)
    ws.send(JSON.stringify({ type: "hello", room: "main", name: "Admin", color: "#ffd700" }));
  };
  ws.onclose = () => {
    connEl.textContent = "Disconnected";
    connEl.className = "conn";
    sendBtn.disabled = true;
  };
  ws.onerror = () => {
    connEl.textContent = "Connection error";
    connEl.className = "conn";
  };
}

wsInput.addEventListener("change", connect);
setTimeout(connect, 300);

sendBtn.addEventListener("click", () => {
  const text = msgInput.value.trim();
  const key = keyInput.value.trim();
  if (!text || !key || !ws || ws.readyState !== WebSocket.OPEN) return;
  ws.send(JSON.stringify({ type: "admin_broadcast", key, text }));
  statusEl.textContent = "Sent!";
  statusEl.className = "status ok";
  msgInput.value = "";
  setTimeout(() => { statusEl.textContent = ""; }, 3000);
});
</script>
</body>
</html>
